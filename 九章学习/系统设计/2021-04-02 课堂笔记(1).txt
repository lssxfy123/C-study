1.文件存储系统？

图片，视频，音频 

文件大小比较大，重合度低
非结构化的数据

Redis 
数据库Mysql


文件系统

HDFS，分布式，可以无限存储容量


2.Hadoop集群

大数据分析
推荐算法，机器学习

3.冷热数据

普通人发的推特，
lady Gaga 推特，大V 访问量非常大


最近发的推文
1个月前发的推文


3.文档 是什么？

文档，是对所有搜索的资源的名称

1个推文 就是1个文档


4.HDFS 的原理弄明白
面试中考察非常多

5.什么是倒排索引？

通过关键词 找到内容， 倒排


6.分词器(Tokenizer)

自然语言处理


7.但是人气数是变化的，在创建索引时就添加进去可能会不准确


每天会去重新构建一次
不是实时准确的，如果要是实时准确，成本就很高，查询的速度就会变慢


8.为啥旧的tweet系统中使用mySql会造成查询方式单一啊？relational database应该可以支持很复杂的查询需求啊？当然可能效率比较低

复杂查询，在这种数量特别大的情况下的，速度，对数据库压力 性能开销大



9.社交关系需要对每两个人直接都结算一次吗？

小明  

推特 存储一个小明关注了哪些人的列表，在对搜索结果排名的时候，会去读这个列表里的信息，关注的人会放相对前面


10.批量索引建立流程

非实时的过程，每天会去跑一次


11.在数据库中，选择什么样的值作为，主键

id，最好是自增的，索引构建的原理，B+
TODO：最好回去自己 看下

12.电商网站的搜索和推特的搜索有什么区别？

没有社交关系
购物推荐和热度。根据商品做的索引。
商品数量少于tweets数量
不只有文字？ 库存数量 价格 产地

13.ES
ES是准实时，接近实时

14.刚才的四种不同的存储都在tweet中都使用到了，老师可以再最后说明一遍每种存储都分别用来存什么吗？
redis 存储实时的数据 最近七天的，%2的推文
文件系统：全量的索引
Hadoop：日志
MySQL：存储在表里的数据，用户表，推文内容表

15.ElasticSearch的自动容错是怎么检测“错误“的，又是怎么做容错处理的？
心跳机制

一个集群中有很多机器，1，2，3  

每隔1min 发送一次心跳
没有发心跳就认为机器挂了，把这个机器的访问转移到其他机器上去

16.搜索结果放在哪个服务的内存中？是wep server吗？
传给前端展示后就删除掉了


17.没看懂Kafka怎么自己更新搜索引擎啊？中间有两个服务吗？一个负责更新搜索引擎，一个负责更新HDFS？
是的，一个负责更新搜索引擎，一个负责更新HDFS


18.请问这里如果类似Google, 有翻页呢？也会删除掉搜索结果么？
分页会再查询一次

如果每次重新查询，这样每页之间，结果会不会有inconsistency。
间隔时间短不会


19.ES-Hadoop是另外一个框架吗？
不是的


20.批量索引建立过程中，每个特征数据“Retweets” “Reviews” 等，每个都是一个数据库吗？还是一个表？它们一般是存在关系型还是非关系型数据库？

最好存储在表中，非实时的的


21.node1 and node2/node3有什么关系。为啥node1是master？

master 主节点 可以指定任意一个节点为主节点


22.老师请问之前Google Doc设计的storage，为什么要存储在File System上，而不是存储在MySQL数据库里？
文件不能存储在数据库的


23.关于用Redis 来存储实时的点赞数和转发数，这个是不是有点overkill啊？因为这个东西的准确度似乎没那么重要，假如1分钟更新一次似乎也能接受。这个解决方案是业界常见的吗？
保护数据库，减少数据库压力

24.社交关系加入搜索结果是一个实时过程吧？
一般是实时的


25.那p1 和 r1/r2的关系，是主分片，副分片，用来replica。node1 和node2/3 ，主节点,副节点是什么意思呢？

多个节点的情况，没有master ，需要领导，主节点起到领导坐

master自动选举

1，2，3

老师，请问master压力会不会比较大？ 不大的


